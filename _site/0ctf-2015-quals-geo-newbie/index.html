<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.13.0 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>0CTF 2015 Quals – geo-newbie - Hacking Tube 2.0</title>
<meta name="description" content="  Talentyange gives lots of tedious apks and you know how bad he is now. Let’s try some interesting geography knowledge.  nc 202.112.26.111  29995 /  nc 202.112.28.118 29995">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Hacking Tube 2.0">
<meta property="og:title" content="0CTF 2015 Quals – geo-newbie">
<meta property="og:url" content="http://0.0.0.0:4000/0ctf-2015-quals-geo-newbie/">


  <meta property="og:description" content="  Talentyange gives lots of tedious apks and you know how bad he is now. Let’s try some interesting geography knowledge.  nc 202.112.26.111  29995 /  nc 202.112.28.118 29995">







  <meta property="article:published_time" content="2015-05-05T22:26:00+08:00">






<link rel="canonical" href="http://0.0.0.0:4000/0ctf-2015-quals-geo-newbie/">













<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Hacking Tube 2.0 Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/">Hacking Tube 2.0</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/about" >About</a>
            </li><li class="masthead__menu-item">
              <a href="/archives/" >Archive</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/other/gravatar.png" alt="Bruce Chen" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Bruce Chen</h3>
    
    
      <p class="author__bio" itemprop="description">
        Vulnerability researcher / CTFer
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Taiwan</span>
        </li>
      

      
        
          
            <li><a href="https://twitter.com/bruce30262"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
          
        
          
            <li><a href="https://github.com/bruce30262"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="0CTF 2015 Quals – geo-newbie">
    <meta itemprop="description" content="  Talentyange gives lots of tedious apks and you know how bad he is now. Let’s try some interesting geography knowledge.  nc 202.112.26.111  29995 /  nc 202.112.28.118 29995">
    <meta itemprop="datePublished" content="May 05, 2015">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">0CTF 2015 Quals – geo-newbie
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <blockquote>
  <p>Talentyange gives lots of tedious apks and you know how bad he is now. Let’s try some interesting geography knowledge.</p>

  <p>nc 202.112.26.111  29995 /  nc 202.112.28.118 29995
<!-- more --></p>
</blockquote>

<p>So basically we just connect to the server, and it will ask us a bunch of questions about geography. We’ll have to pass 3 levels (75 questions) to get the flag.</p>

<p>For level0, it asked us for the <a href="http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2">alpha2 code</a> of a country. For example, if they gave us “JAPAN”, we’ll have to send “JP” back to the server. To pass this level, I download a json file from the internet and use it as the alpha2 code database. Just extract the country name and send the corresponding alpha2 code. After answering 20 questions, we pass level0.</p>

<p>For level1, it gave us a location (ex. Mount Fuji), and we’ll have to answer the country (in alpha2 code format, ex. <strong>Mount Fuji</strong> –&gt; <strong>JP</strong>) that contains the location. To pass the level, I use the <a href="http://maps.googleapis.com/maps/api/geocode/json">google API</a> to solve the problems. Extract the location and pass it as the “address” parameter, the API will respond with a json format response. Parse the response and get the correct country 
name. Notice that sometimes google API will respond a wrong country(mostly it respond US instead of the correct country), so we will need to handle some special cases (by hard-code the correct answer in the script). This level has 50 questions, solve them all and we’ll be able to reach level2.</p>

<p>And for the last level, the server gave us a river or a moutain (ex. Congo River, Andes Mountains….etc), and we’ll have to answer all the countries that the given river/mountain run across. To pass this level, I just hard-code all the answer in the script. First we’ll have to reach level2 several times, collect as much rivers/mountains as we can, then google the answer, hard-code them in the script. I add some conditions in my script. If the program encounters a river/mountain that it already has the answer in the script, it will send the answer to the server. Or else, it’ll switch to the interactive mode , and I’ll take control of the situation – by google &amp; send the answer with my own hand ( you know, speed mode activated ! )</p>

<p>Here’s the script I used for solving the challenge:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">import</span> <span class="nn">urllib</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">'http://maps.googleapis.com/maps/api/geocode/json'</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">values</span><span class="p">[</span><span class="s">'sensor'</span><span class="p">]</span> <span class="o">=</span> <span class="s">"false"</span>

<span class="n">HOST</span> <span class="o">=</span> <span class="s">"202.112.26.111"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">29995</span>
<span class="n">TIME</span> <span class="o">=</span> <span class="mf">0.8</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">'level0.json'</span><span class="p">)</span> <span class="k">as</span> <span class="n">alpha2_file</span><span class="p">:</span>
    <span class="n">alpha2</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">alpha2_file</span><span class="p">)</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_alpha2</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">alpha2</span>
    <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">alpha2</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">country</span><span class="p">[</span><span class="s">"Name"</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span> <span class="o">==</span> <span class="n">s</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">country</span><span class="p">[</span><span class="s">"Code"</span><span class="p">]</span>  

<span class="k">def</span> <span class="nf">solve_level1</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
	<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s">"Naples"</span><span class="p">:</span>
		<span class="k">return</span> <span class="s">"IT"</span>
	<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s">"Vancouver"</span><span class="p">:</span>
		<span class="k">return</span> <span class="s">"CA"</span>
	<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s">"Volga"</span><span class="p">:</span>
		<span class="k">return</span> <span class="s">"RU"</span>
	<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s">"Lego"</span><span class="p">:</span>
		<span class="k">return</span> <span class="s">"DK"</span>
	<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s">"Hyde Park"</span><span class="p">:</span>
		<span class="k">return</span> <span class="s">"GB"</span>
	<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s">"Alexandria"</span><span class="p">:</span>
		<span class="k">return</span> <span class="s">"EG"</span>
	<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s">"Melboume"</span><span class="p">:</span>
		<span class="k">return</span> <span class="s">"AU"</span>
	<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s">"Rickshaw capital of the world"</span><span class="p">:</span>
		<span class="k">return</span> <span class="s">"BD"</span>
	<span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="s">"Mount Olympus"</span><span class="p">:</span>
		<span class="k">return</span> <span class="s">"GR"</span>
		
	<span class="k">global</span> <span class="n">url</span><span class="p">,</span> <span class="n">values</span>
	<span class="n">values</span><span class="p">[</span><span class="s">'address'</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span>
	<span class="n">data</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
	<span class="n">resp</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="s">'?'</span><span class="o">+</span><span class="n">data</span><span class="p">))</span>

	<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">resp</span><span class="p">[</span><span class="s">"results"</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">"address_components"</span><span class="p">]:</span>
		<span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="s">"types"</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">"country"</span><span class="p">:</span>
			<span class="k">print</span> <span class="n">c</span><span class="p">[</span><span class="s">"short_name"</span><span class="p">]</span>
			<span class="k">return</span> <span class="n">c</span><span class="p">[</span><span class="s">"short_name"</span><span class="p">]</span>

<span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Tell me the Alpha-2 code of country."</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">"res"</span><span class="p">,</span> <span class="n">res</span>
    <span class="c">#country = re.search("--- Round (\d+) ---\n(\S+ ):", res).groups(0)[1]</span>
    <span class="n">country</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">res</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">"-</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="n">res</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">":"</span><span class="p">):]</span>
    <span class="k">print</span> <span class="s">"now:"</span><span class="p">,</span> <span class="n">country</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="n">get_alpha2</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">"ans:"</span><span class="p">,</span> <span class="n">ans</span>
    <span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">ans</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">"res"</span><span class="p">,</span> <span class="n">res</span>
    <span class="n">country</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">res</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">"-</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="n">res</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">":"</span><span class="p">):]</span>
    <span class="k">print</span> <span class="s">"now:"</span><span class="p">,</span> <span class="n">country</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="n">solve_level1</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">"ans:"</span><span class="p">,</span> <span class="n">ans</span>
    <span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">ans</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>

<span class="c"># level2, not all the case</span>
<span class="n">Congo_River</span> <span class="o">=</span> <span class="p">[</span><span class="s">"AO"</span><span class="p">,</span> <span class="s">"BI"</span><span class="p">,</span> <span class="s">"CM"</span><span class="p">,</span> <span class="s">"CF"</span><span class="p">,</span> <span class="s">"CD"</span><span class="p">,</span> <span class="s">"GA"</span><span class="p">,</span> <span class="s">"CG"</span><span class="p">,</span> <span class="s">"RW"</span><span class="p">,</span> <span class="s">"TZ"</span><span class="p">,</span> <span class="s">"ZM"</span><span class="p">]</span>
<span class="n">Alps</span> <span class="o">=</span> <span class="p">[</span><span class="s">"CH"</span><span class="p">,</span> <span class="s">"AT"</span><span class="p">,</span> <span class="s">"LI"</span><span class="p">,</span> <span class="s">"DE"</span><span class="p">,</span> <span class="s">"IT"</span><span class="p">,</span> <span class="s">"SI"</span><span class="p">,</span> <span class="s">"FR"</span><span class="p">]</span>
<span class="n">Andes</span> <span class="o">=</span> <span class="p">[</span><span class="s">"AR"</span><span class="p">,</span> <span class="s">"BO"</span><span class="p">,</span> <span class="s">"CL"</span><span class="p">,</span> <span class="s">"CO"</span><span class="p">,</span> <span class="s">"EC"</span><span class="p">,</span> <span class="s">"PE"</span><span class="p">,</span> <span class="s">"VE"</span><span class="p">]</span>
<span class="n">Himalayas</span> <span class="o">=</span> <span class="p">[</span><span class="s">"BT"</span><span class="p">,</span> <span class="s">"NP"</span><span class="p">,</span> <span class="s">"CN"</span><span class="p">,</span> <span class="s">"IN"</span><span class="p">,</span> <span class="s">"PK"</span><span class="p">]</span>
<span class="n">Mekong_River</span> <span class="o">=</span> <span class="p">[</span><span class="s">"CN"</span><span class="p">,</span> <span class="s">"MM"</span><span class="p">,</span> <span class="s">"LA"</span><span class="p">,</span> <span class="s">"TH"</span><span class="p">,</span> <span class="s">"KH"</span><span class="p">,</span> <span class="s">"VN"</span><span class="p">]</span>
<span class="n">Rocky_Mountain</span> <span class="o">=</span> <span class="p">[</span><span class="s">"CA"</span><span class="p">,</span> <span class="s">"US"</span><span class="p">]</span>
<span class="n">Parana_River</span> <span class="o">=</span> <span class="p">[</span><span class="s">"AR"</span><span class="p">,</span> <span class="s">"BR"</span><span class="p">,</span> <span class="s">"PY"</span><span class="p">]</span>
<span class="n">Nile</span> <span class="o">=</span> <span class="p">[</span><span class="s">"ET"</span><span class="p">,</span> <span class="s">"SD"</span><span class="p">,</span> <span class="s">"EG"</span><span class="p">,</span> <span class="s">"UG"</span><span class="p">,</span> <span class="s">"CD"</span><span class="p">,</span> <span class="s">"KE"</span><span class="p">,</span> <span class="s">"TZ"</span><span class="p">,</span> <span class="s">"RW"</span><span class="p">,</span> <span class="s">"SS"</span><span class="p">,</span> <span class="s">"ER"</span><span class="p">,</span> <span class="s">"BI"</span><span class="p">]</span>
<span class="n">Apennine</span> <span class="o">=</span> <span class="p">[</span><span class="s">"IT"</span><span class="p">,</span> <span class="s">"SM"</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span> <span class="mi">75</span><span class="p">):</span>
	<span class="n">res</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
	<span class="k">print</span> <span class="s">"res"</span><span class="p">,</span> <span class="n">res</span>

	<span class="k">if</span> <span class="s">"Congo River"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Congo_River</span><span class="p">):</span>
			<span class="k">print</span> <span class="s">"send:"</span><span class="p">,</span> <span class="n">c</span>
			<span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
			<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Congo_River</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">break</span>
			<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
	<span class="k">if</span> <span class="s">"Alps"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Alps</span><span class="p">):</span>
			<span class="k">print</span> <span class="s">"send:"</span><span class="p">,</span> <span class="n">c</span>
			<span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
			<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Alps</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">break</span>
			<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
	<span class="k">if</span> <span class="s">"Andes"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Andes</span><span class="p">):</span>
			<span class="k">print</span> <span class="s">"send:"</span><span class="p">,</span> <span class="n">c</span>
			<span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
			<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Andes</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">break</span>
			<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
	<span class="k">if</span> <span class="s">"Himalayas"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Himalayas</span><span class="p">):</span>
			<span class="k">print</span> <span class="s">"send:"</span><span class="p">,</span> <span class="n">c</span>
			<span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
			<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Himalayas</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">break</span>
			<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
	<span class="k">if</span> <span class="s">"Mekong River"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Mekong_River</span><span class="p">):</span>
			<span class="k">print</span> <span class="s">"send:"</span><span class="p">,</span> <span class="n">c</span>
			<span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
			<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Mekong_River</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">break</span>
			<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
	<span class="k">if</span> <span class="s">"Rocky Mountain"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Rocky_Mountain</span><span class="p">):</span>
			<span class="k">print</span> <span class="s">"send:"</span><span class="p">,</span> <span class="n">c</span>
			<span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
			<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Rocky_Mountain</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">break</span>
			<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
	<span class="k">if</span> <span class="s">"Nile"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Nile</span><span class="p">):</span>
			<span class="k">print</span> <span class="s">"send:"</span><span class="p">,</span> <span class="n">c</span>
			<span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
			<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Nile</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">break</span>
			<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
	<span class="k">if</span> <span class="s">"Parana River"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Parana_River</span><span class="p">):</span>
			<span class="k">print</span> <span class="s">"send:"</span><span class="p">,</span> <span class="n">c</span>
			<span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
			<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Parana_River</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">break</span>
			<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
	<span class="k">if</span> <span class="s">"Apennine Mountains"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Apennine</span><span class="p">):</span>
			<span class="k">print</span> <span class="s">"send:"</span><span class="p">,</span> <span class="n">c</span>
			<span class="n">r</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">c</span><span class="o">+</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
			<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Apennine</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="k">break</span>
			<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span> <span class="c"># solve by hand</span>
		<span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
	<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">TIME</span><span class="p">)</span>
</code></pre></div></div>

<p>After answering all the questions, we get the flag: <code class="highlighter-rouge">0CTF{eNj0y_geography_l0v3_7hE_w0lRd}</code></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#0ctf" class="page__taxonomy-item" rel="tag">0CTF</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#ctf" class="page__taxonomy-item" rel="tag">CTF</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#misc" class="page__taxonomy-item" rel="tag">Misc</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#ppc" class="page__taxonomy-item" rel="tag">PPC</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#python" class="page__taxonomy-item" rel="tag">Python</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#xctf" class="page__taxonomy-item" rel="tag">XCTF</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#write-ups" class="page__taxonomy-item" rel="tag">write-ups</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2015-05-05T22:26:00+08:00">May 05, 2015</time></p>
        
      </footer>

      <!-- /usr/gem/gems/minimal-mistakes-jekyll-4.13.0/_includes/social-share.html -->
<!-- Remove linkdin shared button -->
<section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=0CTF+2015+Quals+--+geo-newbie%20http%3A%2F%2F0.0.0.0%3A4000%2F0ctf-2015-quals-geo-newbie%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2F0.0.0.0%3A4000%2F0ctf-2015-quals-geo-newbie%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2F0.0.0.0%3A4000%2F0ctf-2015-quals-geo-newbie%2F" class="btn btn--google-plus" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Google Plus"><i class="fab fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

</section>


      
  <nav class="pagination">
    
      <a href="/0ctf-2015-quals-babypolyquine/" class="pagination--pager" title="0CTF 2015 Quals – (Baby)PolyQuine
">Previous</a>
    
    
      <a href="/backdoorctf-2015-binary-misc/" class="pagination--pager" title="BackdoorCTF 2015 – Binary + Misc
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Chakrazy-exploiting-type-confusion-bug-in-ChakraCore/" rel="permalink">Chakrazy – exploiting type confusion bug in ChakraCore engine
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Introduction

</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Learning-browser-exploitation-via-33C3-CTF-feuerfuchs-challenge/" rel="permalink">Learning browser exploitation via 33C3 CTF  feuerfuchs challenge
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Introduction

</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/hxp-CTF-2017-hardened-flag-store/" rel="permalink">hxp CTF 2017 – hardened_flag_store
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Category: Pwnable

</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/MeePwn-CTF-2017-Brainfuck-1-2/" rel="permalink">MeePwn CTF 2017 – Brainfuck 1 &amp; 2
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Category: Pwnable

</p>
  </article>
</div>
        
      </div>
    </div>
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><input type="text" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    <div id="results" class="results"></div></div>
      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Bruce Chen. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.2.0/js/all.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://0.0.0.0:4000/0ctf-2015-quals-geo-newbie/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/0ctf-2015-quals-geo-newbie"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://bruce30262logdown.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  



  </body>
</html>